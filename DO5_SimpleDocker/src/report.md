## Part 1. Готовый докер

- Возьми официальный докер-образ с nginx и выкачай его при помощи docker pull.

    ![](img/Part_1_01.png)

- Проверь наличие докер-образа через `docker images`.

    ![](img/Part_1_02.png)

- Запусти докер-образ через `docker run -d [image_id|repository]`.

    ![](img/Part_1_03.png)

- Проверь, что образ запустился через `docker ps`.

    ![](img/Part_1_04.png)

- Посмотри информацию о контейнере через `docker inspect [container_id|container_name]`.
- По выводу команды определи и помести в отчёт размер контейнера, список замапленных портов и ip контейнера.

    ![](img/Part_1_05.png)

- Останови докер контейнер через `docker stop [container_id|container_name]`.

    ![](img/Part_1_06.png)

- Проверь, что контейнер остановился через `docker ps`.

    ![](img/Part_1_07.png)

- Запусти докер с портами 80 и 443 в контейнере, замапленными на такие же порты на локальной машине, через команду `run`.

    ![](img/Part_1_08.png)

- Проверь, что в браузере по адресу localhost:80 доступна стартовая страница nginx.

    ![](img/Part_1_09.png)

- Перезапусти докер контейнер через `docker restart [container_id|container_name]`.
- Проверь любым способом, что контейнер запустился.

    ![](img/Part_1_10.png)

## Part 2. Операции с контейнером

- Прочитай конфигурационный файл nginx.conf внутри докер контейнера через команду `exec`.

    ![](img/Part_2_01.png)

- Создай на локальной машине файл nginx.conf.
- Настрой в нем по пути /status отдачу страницы статуса сервера nginx.
- Скопируй созданный файл nginx.conf внутрь докер-образа через команду `docker cp`.

    ![](img/Part_2_02.png)

- Перезапусти nginx внутри докер-образа через команду `exec`.
- Проверь, что по адресу localhost:80/status отдается страничка со статусом сервера nginx.

    ![](img/Part_2_03.png)

- Экспортируй контейнер в файл container.tar через команду `export`.

    ![](img/Part_2_04.png)

- Останови контейнер.

    ![](img/Part_2_05.png)

- Удали образ через `docker rmi [image_id|repository]`, не удаляя перед этим контейнеры.

    ![](img/Part_2_06.png)

- Удали остановленный контейнер.

    ![](img/Part_2_07.png)

- Импортируй контейнер обратно через команду `import`.
- Запусти импортированный контейнер.

    ![](img/Part_2_08.png)
    ![](img/Part_2_09.png)

- Проверь, что по адресу localhost:80/status отдается страничка со статусом сервера nginx.

    ![](img/Part_2_10.png)

## Part 3. Мини веб-сервер

- Напиши мини-сервер на C и FastCgi, который будет возвращать простейшую страничку с надписью Hello World!.
- Запусти написанный мини-сервер через spawn-fcgi на порту 8080.
- Напиши свой nginx.conf, который будет проксировать все запросы с 81 порта на 127.0.0.1:8080.

    ![](img/Part_3_01.png)
    ![](img/Part_3_02.png)

- Обновление и установка: `docker exec server apt update` `docker exec server apt install -y gcc spawn-fcgi libfcgi-dev`
- Копирование файлов: 

    ![](img/Part_3_03.png)

- Обновление конфигурации nginx: `docker exec server nginx -s reload`
- Компиляция: `docker exec server gcc ./fastcgi_server.c -lfcgi -o fcgi_server`
- Запуск: `docker exec server spawn-fcgi -p 8080 fcgi_server`

- Проверь, что в браузере по localhost:81 отдается написанная тобой страничка.

    ![](img/Part_3_04.png)

- Положи файл nginx.conf по пути ./nginx/nginx.conf (это понадобится позже).

## Part 4. Свой докер

- Напиши свой докер-образ, который:
1) собирает исходники мини сервера на FastCgi из Части 3;
2) запускает его на 8080 порту;
3) копирует внутрь образа написанный ./nginx/nginx.conf;
4) запускает nginx.

- nginx можно установить внутрь докера самостоятельно, а можно воспользоваться готовым образом с nginx'ом, как базовым.
- Собери написанный докер-образ через `docker build` при этом указав имя и тег.

    ![](img/Part_4_01.png)

- Проверь через `docker images`, что все собралось корректно.

    ![](img/Part_4_02.png)

- Запусти собранный докер-образ с маппингом 81 порта на 80 на локальной машине и маппингом папки ./nginx внутрь контейнера по адресу, где лежат конфигурационные файлы nginx'а (см. Часть 2).

    ![](img/Part_4_03.png)

- Проверь, что по localhost:80 доступна страничка написанного мини сервера.

    ![](img/Part_4_04.png)

- Допиши в ./nginx/nginx.conf проксирование странички /status, по которой надо отдавать статус сервера nginx.
- Перезапусти докер-образ.
- Если всё сделано верно, то, после сохранения файла и перезапуска контейнера, конфигурационный файл внутри докер-образа должен обновиться самостоятельно без лишних действий.
- Проверь, что теперь по localhost:80/status отдается страничка со статусом nginx

    ![](img/Part_4_05.png)

## Part 5. Dockle

- Просканируй образ из предыдущего задания через `dockle [image_id|repository]`.

    ![](img/Part_5_01.png)

- Исправь образ так, чтобы при проверке через dockle не было ошибок и предупреждений.

    ![](img/Part_5_02.png)

## Part 6. Базовый Docker Compose

- Напиши файл docker-compose.yml, с помощью которого:
1) Подними докер-контейнер из Части 5 (он должен работать в локальной сети, т. е. не нужно использовать инструкцию EXPOSE и мапить порты на локальную машину).
2) Подними докер-контейнер с nginx, который будет проксировать все запросы с 8080 порта на 81 порт первого контейнера.
- Замапь 8080 порт второго контейнера на 80 порт локальной машины.
- Останови все запущенные контейнеры.
- Собери и запусти проект с помощью команд `docker-compose build` и `docker-compose up`.

    ![](img/Part_6_01.png)
    ![](img/Part_6_02.png)

- Проверь, что в браузере по localhost:80 отдается написанная тобой страничка, как и ранее.

    ![](img/Part_6_03.png)
